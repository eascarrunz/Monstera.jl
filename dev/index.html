<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Monstera.jl Documentation · Monstera.jl</title><meta name="title" content="Monstera.jl Documentation · Monstera.jl"/><meta property="og:title" content="Monstera.jl Documentation · Monstera.jl"/><meta property="twitter:title" content="Monstera.jl Documentation · Monstera.jl"/><meta name="description" content="Documentation for Monstera.jl."/><meta property="og:description" content="Documentation for Monstera.jl."/><meta property="twitter:description" content="Documentation for Monstera.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Monstera.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Monstera.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Quick-Introduction"><span>Quick Introduction</span></a></li><li><a class="tocitem" href="#The-RoundaboutTree-type"><span>The <code>RoundaboutTree</code> type</span></a></li></ul></li><li><a class="tocitem" href="docstrings/">-</a></li><li><a class="tocitem" href="interface/">Interface</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Monstera.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Monstera.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eascarrunz/Monstera.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/eascarrunz/Monstera.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Monstera.jl-Documentation"><a class="docs-heading-anchor" href="#Monstera.jl-Documentation">Monstera.jl Documentation</a><a id="Monstera.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Monstera.jl-Documentation" title="Permalink"></a></h1><p>This is an experimental package for phylogenetics in Julia.</p><p>These are the main objectives of this package:</p><ul><li>Provide a general interface for basic operations with phylogenetic trees, allowing the </li></ul><p>experimentation with a variety of data structures to represent trees</p><ul><li><p>Allow as much flexibility as possible:</p><ul><li>Taxa can live in inner or outer nodes</li><li>Non-splitting nodes are permitted</li></ul></li><li><p>Be ergonomic for interactive use</p></li></ul><p>Only one base tree type is available for now: <code>RoundaboutTree</code> (see below).</p><h2 id="Quick-Introduction"><a class="docs-heading-anchor" href="#Quick-Introduction">Quick Introduction</a><a id="Quick-Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Introduction" title="Permalink"></a></h2><p>Let&#39;s start off loading a tree in Newick format. This is a little extract of the tree of the Araceae from Haigh et al. (2022): </p><pre><code class="language-julia-repl hljs">julia&gt; philo_string = &quot;(((Philodendron,Adelonema),(Homalomena,Furtadoa)),(Cercestis,Culcasia),Monstera);&quot;;
</code></pre><p>We can create a tree object from that string using the <code>Newick.parse</code> method, and specifying the tree type that we want. Only one tree type is available for now: <code>RoundaboutTree</code>. Optionally, we can create a <code>TaxonSet</code> from the labels of the tree.</p><pre><code class="language-julia-repl hljs">julia&gt; philo_tree = Newick.parse(RoundaboutTree, philo_string, TaxonSet())
RoundaboutTree: 12 nodes, 11 branches</code></pre><p>Let&#39;s take a look at it. The <code>textplot</code> function will print a diagram of the tree:</p><pre><code class="language-julia-repl hljs">julia&gt; textplot(philo_tree)
             ┌───────●(4)Philodendron
     ┌───────○(3)
     │       └───────●(5)Adelonema
┌────○(2)
│    │       ┌───────●(7)Homalomena
│    └───────○(6)
│            └───────●(8)Furtadoa
○(1)
│    ┌───────●(10)Cercestis
├────○(9)
│    └───────●(11)Culcasia
│
└────●(12)Monstera</code></pre><p>Nodes are represented by small circles, with numerical identifiers in parentheses. Next to that, node labels are shown. Nodes are objects, and they can be retrieved from the tree by their IDs. For instance, let&#39;s take a look at nodes #3 and #4, and their main properties.</p><pre><code class="language-julia-repl hljs">julia&gt; philo_tree.nodes[3]
RoundaboutNode #3 (no taxon)
julia&gt; philo_tree.nodes[3].id
3
julia&gt; philo_tree.nodes[3].taxon
0
julia&gt; philo_tree.nodes[3].label
&quot;&quot;
julia&gt; philo_tree.nodes[4]
RoundaboutNode #4 (taxon 1) - &quot;Philodendron&quot;
julia&gt; philo_tree.nodes[4].id
4
julia&gt; philo_tree.nodes[4].taxon
1
julia&gt; philo_tree.nodes[4].label
&quot;Philodendron&quot;</code></pre><p>Nodes can be associated to a taxon with its own numeric ID in a <code>TaxonSet</code>, or have no taxon (interally represented with a <code>0</code>). Also, the diagram from <code>textplot</code> represents nodes with  taxa as filled circles. The taxon set is property of the tree, accessible as <code>philo_tree.taxonset</code>. A single taxon set object is shared with groups of trees that represent the same group of taxa.</p><p>Branches are have IDs, like nodes, and are accessible with the <code>branches</code> property.</p><pre><code class="language-julia-repl hljs">julia&gt; philo_tree.branches
11-element Vector{RoundaboutBranch}:
 RoundaboutBranch #1: 1 ○⎯⎯⎯○ 2 (length NaN)
 RoundaboutBranch #2: 2 ○⎯⎯⎯○ 3 (length NaN)
 RoundaboutBranch #3: 3 ○⎯⎯⎯● 4 (length NaN)
 RoundaboutBranch #4: 3 ○⎯⎯⎯● 5 (length NaN)
 RoundaboutBranch #5: 2 ○⎯⎯⎯○ 6 (length NaN)
 RoundaboutBranch #6: 6 ○⎯⎯⎯● 7 (length NaN)
 RoundaboutBranch #7: 6 ○⎯⎯⎯● 8 (length NaN)
 RoundaboutBranch #8: 1 ○⎯⎯⎯○ 9 (length NaN)
 RoundaboutBranch #9: 9 ○⎯⎯⎯● 10 (length NaN)
 RoundaboutBranch #10: 9 ○⎯⎯⎯● 11 (length NaN)
 RoundaboutBranch #11: 1 ○⎯⎯⎯● 12 (length NaN)</code></pre><p>Little diagrams of the branches show the nodes to which they are attached. We have no branch lengths in this example, so the &quot;length&quot; value is set to <code>NaN</code>.</p><h3 id="Orientation-conventions-and-the-branch-node-notation"><a class="docs-heading-anchor" href="#Orientation-conventions-and-the-branch-node-notation">Orientation conventions and the <code>branch =&gt; node</code> notation</a><a id="Orientation-conventions-and-the-branch-node-notation-1"></a><a class="docs-heading-anchor-permalink" href="#Orientation-conventions-and-the-branch-node-notation" title="Permalink"></a></h3><p>This is a central concept in the Monstera package. Tree objects can have an intrinsic  orientation, so that branches are directed outward from the root node. Monstera also makes  it possible to traverse the tree in any arbitrary direction by means of special conventions  in function calls. For instance, if we have a function <code>f</code> that traverses a tree, or a  sub-tree of a tree, we can call <code>f</code> in a number of ways to indicate exactly what part of the  tree to traverse, and in what direction:</p><table><tr><th style="text-align: right">Notation</th><th style="text-align: right">Meaning</th></tr><tr><td style="text-align: right"><code>f(tree)</code></td><td style="text-align: right">Traverse the entire tree starting from its root node</td></tr><tr><td style="text-align: right"><code>f(node)</code></td><td style="text-align: right">Traverse the part of the tree that descends from a node, following to the intrinsic orientation of the tree</td></tr><tr><td style="text-align: right"><code>f(nothing =&gt; node)</code></td><td style="text-align: right">Traverse the entire tree as if it were rooted on a node</td></tr><tr><td style="text-align: right"><code>f(branch =&gt; node)</code></td><td style="text-align: right">Traverse the part of the tree that descends from a node, with the parent-child direction indicated by the branch-node pair</td></tr></table><p>The <code>textplot</code> function is one of the many functions that work in this way. It prints a  diagram of the tree, or a sub-tree, using characters on a terminal window.  Let&#39;s see it in  action. First, we create a tree from a Newick string, and we plot it with  <code>textplot(tree)</code>. The tree is plotted from left to right, from its root node.</p><pre><code class="language-julia-repl hljs">julia&gt; tree = Newick.parse(RoundaboutTree, &quot;(((A,B),C),(D,E),H);&quot;);

julia&gt; textplot(tree)
             ┌───────○(4)A
     ┌───────○(3)
┌────○(2)    └───────○(5)B
│    │
│    └───────○(6)C
│
○(1) ┌───────○(8)D
├────○(7)
│    └───────○(9)E
│
└────○(10)H</code></pre><p>As node #1 is the root node, <code>textplot(tree.nodes[1])</code> or <code>textplot(tree.root)</code> produces an  identical result.</p><pre><code class="language-julia-repl hljs">julia&gt; textplot(tree.nodes[1])
             ┌───────○(4)A
     ┌───────○(3)
┌────○(2)    └───────○(5)B
│    │
│    └───────○(6)C
│
○(1) ┌───────○(8)D
├────○(7)
│    └───────○(9)E
│
└────○(10)H</code></pre><p>If we do the same with node #2 instead, we get the corresponding sub-tree.</p><pre><code class="language-julia-repl hljs">julia&gt; textplot(tree.nodes[2])
     ┌───────○(4)A
┌────○(3)
○(2) └───────○(5)B
│
└────○(6)C</code></pre><p>The <code>branch =&gt; node</code> notation gives us a more flexible way to plot sub-trees, but we need to know which branches are connecting which nodes. We get the information we need just by  showing the branch list on the REPL.</p><pre><code class="language-julia-repl hljs">julia&gt; tree.branches
9-element Vector{RoundaboutBranch}:
 RoundaboutBranch #1: 1 ○⎯⎯⎯○ 2 (length NaN)
 RoundaboutBranch #2: 2 ○⎯⎯⎯○ 3 (length NaN)
 RoundaboutBranch #3: 3 ○⎯⎯⎯○ 4 (length NaN)
 RoundaboutBranch #4: 3 ○⎯⎯⎯○ 5 (length NaN)
 RoundaboutBranch #5: 2 ○⎯⎯⎯○ 6 (length NaN)
 RoundaboutBranch #6: 1 ○⎯⎯⎯○ 7 (length NaN)
 RoundaboutBranch #7: 7 ○⎯⎯⎯○ 8 (length NaN)
 RoundaboutBranch #8: 7 ○⎯⎯⎯○ 9 (length NaN)
 RoundaboutBranch #9: 1 ○⎯⎯⎯○ 10 (length NaN)</code></pre><p>Since branch #1 connects node #1 (the root) to node #2,  <code>textplot(tree.branches[1] =&gt; tree.nodes[2])</code> will print the same sub-tree as in the  previous example.</p><pre><code class="language-julia-repl hljs">julia&gt; textplot(tree.branches[1] =&gt; tree.nodes[2])
     ┌───────○(4)A
┌────○(3)
○(2) └───────○(5)B
│
└────○(6)C</code></pre><p>With the <code>branch =&gt; node</code> notation, we can plot sub-trees with a completely different  orientation, without actually changing the root of the tree. The key is that we consider the given <code>branch</code> as coming from the parent of the <code>node</code>. Take a look at the following  example:</p><pre><code class="language-julia-repl hljs">julia&gt; textplot(tree.branches[2] =&gt; tree.nodes[2])
┌────○(6)C
│
○(2)         ┌───────○(8)D
│    ┌───────○(7)
└────○(1)    └───────○(9)E
     │
     └───────○(10)H</code></pre><p>Branch #2 connects node #2 to node #3, so we are in effect plotting the sub-tree of node #2 as though node #3 were its parent. Hence, node #1, the true root of the tree, appears as a descendant of node #2, and node #3 is left out.</p><p>The <code>branch =&gt; node</code> notation also gives us the ability to plot the entire tree as though  any node were the root of the tree. Since a &quot;proper&quot; root node has no parent, we replace the <code>branch</code> with <code>nothing</code>, like so:</p><pre><code class="language-julia-repl hljs">julia&gt; textplot(nothing =&gt; tree.nodes[2])
     ┌───────○(4)A
┌────○(3)
│    └───────○(5)B
│
○(2)─○(6)C
│
│            ┌───────○(8)D
│    ┌───────○(7)
└────○(1)    └───────○(9)E
     │
     └───────○(10)H</code></pre><p>The usefulness of having all these options for defining tree orientations might not be  obvious in common use cases, but it has practical value. For instance, in many cases the root of the tree might not be biologically meaningful, such as in trees inferred by  maximum-likelihood without an explicit outgroup.</p><p>Also, some important algorithms require  treating any arbitrary node as the root of the tree, as in maximum-likelihood branch length  optimisation.</p><p>Finally, the <code>branch =&gt; node</code> notation also a useful <em>return value</em> of many functions. The <code>children</code> function, for instance, returns an iterator of <code>branch =&gt; node</code>  pairs: instead of just listing the children nodes, we get the corresponding branch and node of each child.</p><pre><code class="language-julia-repl hljs">julia&gt; collect(children(tree.branches[2] =&gt; tree.nodes[2]))
2-element Vector{Pair{RoundaboutBranch{RoundaboutNode}, RoundaboutNode}}:
 RoundaboutBranch #5 =&gt; RoundaboutNode #6 (no taxon) - &quot;C&quot;
 RoundaboutBranch #1 =&gt; RoundaboutNode #1 (no taxon)</code></pre><h2 id="The-RoundaboutTree-type"><a class="docs-heading-anchor" href="#The-RoundaboutTree-type">The <code>RoundaboutTree</code> type</a><a id="The-RoundaboutTree-type-1"></a><a class="docs-heading-anchor-permalink" href="#The-RoundaboutTree-type" title="Permalink"></a></h2><p>This type implements a complex data structure based on circular linked lists of branches  surrounding nodes: &quot;roundabouts&quot; of branches. The use of linked lists makes the construction  and modification of trees very fast, as it avoids allocations associated to array-based   lists. This comes at the cost of complexity and indirections that slow down tree   traversals.</p><p>Each <code>RoundaboutBranch</code> object has a &quot;left&quot; and &quot;right&quot; side. They correspond to the  &quot;parent&quot; and &quot;child&quot; sides of the branch, following the orientation in which the tree was  constructed, for instance, from a Newick string.</p><p>Each side of a branch contain fields with the following information:</p><ul><li>A reference to the <code>RoundaboutNode</code> connected by this side, or <code>nothing</code> if there is no node yet (this should only happen in intermediate stages of tree construction or branch swapping)</li><li>A reference to the next <code>RoundaboutBranch</code> connected to this side&#39;s node. If there are no</li></ul><p>other branches, this field points back to the present branch.</p><ul><li>An instance of the side type of the next <code>RoundaboutBranch</code> which is connected to this side&#39;s node.</li></ul><p>Side types are <code>RoundaboutLeft</code>, <code>RoundaboutRight</code> and <code>RoundaboutNoSide</code>; subtypes of <code>RoundaboutSide</code>.</p><p>The <code>RoundaboutNode</code> objects contain a reference to the last <code>RoundaboutBranch</code> that was connected to them. This provides quick access to both the head and tail of the circular  list.</p><p>The <code>RoundaboutTree</code> data structure is a spin on Felsenstein&#39;s nodelet-based tree data  structure (Felsenstein 2004), used in PHYLIP and in the Phylogenetic Likelihood Library used by RAxML-NG. I replaced the pairs of &quot;nodelets&quot; pointing back to each other with single  branches that contain two sides. I also made nodes concrete objects, insetad of emerging  properties of cycles of nodelets. The advantage is that this structure fits a generic tree  interface better, and it is conceptually simpler and easier to use in interactive  programming.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="docstrings/">- »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 22 March 2024 19:22">Friday 22 March 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
